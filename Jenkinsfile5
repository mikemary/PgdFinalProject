pipeline{
    tools{
        maven 'mymaven'
         }
    env{
    $DOCKER_USERNAME= 'moyinlola'
    $DOCKER_PASSWORD= '@Adura1972'
    agent any
    
    stages{
        stage('Checkout on git'){
            agent any
            steps{
                git 'https://github.com/mikemary/PgdFinalProject.git'
            }
        }
        stage('Compile'){
            agent any
            steps{
                sh 'mvn compile'
            }
        }
        
        stage('UnitTest'){
            steps{
                sh 'mvn test'
            }
        }
        
        stage('Package'){
            steps{
                sh 'mvn package'
            }
        }
        stage('Building image') {
            steps{
                script {
                    sh 'docker build -t abctechnologies:$BUILD_NUMBER  .'
                    }
                }
         
        }
             stage('Push Docker Image to Docker Hub'){
                steps{
                 sh 'docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD'
                 sh 'docker tag abctechnologies $DOCKER_USERNAME/abctechnologies: latest'
                 sh 'docker push $DOCKER_USERNAME/abctechnologieS: latest
                }
            }    
                

        
        }}
    }
}
